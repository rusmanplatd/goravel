{{define "tasks/create.tmpl"}}
<div class="row justify-content-center">
    <div class="col-lg-8 col-xl-6">
        <div class="d-flex align-items-center mb-4">
            <a href="/tasks" class="btn btn-outline-secondary btn-sm me-3">
                <i class="fas fa-arrow-left me-1"></i>Back to Tasks
            </a>
            <div>
                <h1 class="h3 fw-semibold text-dark mb-1">Create Task</h1>
                <p class="text-muted mb-0">Add a new task to your project</p>
            </div>
        </div>

        <div class="card shadow-sm">
            <div class="card-body p-4">
                <form method="POST" action="/tasks" id="taskForm">
                    <!-- Task Title -->
                    <div class="mb-4">
                        <label for="title" class="form-label fw-medium">Task Title <span class="text-danger">*</span></label>
                        <input type="text" class="form-control form-control-lg" id="title" name="title" required 
                               placeholder="e.g., Implement user authentication, Design dashboard UI">
                        <div class="form-text">Choose a clear, actionable title for your task</div>
                    </div>

                    <!-- Task Description -->
                    <div class="mb-4">
                        <label for="description" class="form-label fw-medium">Description</label>
                        <textarea class="form-control" id="description" name="description" rows="4" 
                                  placeholder="Describe what needs to be done, acceptance criteria, and any important details..."></textarea>
                        <div class="form-text">Provide clear requirements and expectations</div>
                    </div>

                    <!-- Project Assignment -->
                    <div class="mb-4">
                        <label for="project" class="form-label fw-medium">Project <span class="text-danger">*</span></label>
                        <select class="form-select" id="project" name="project" required>
                            <option value="">Select a project...</option>
                            <option value="project-alpha">Project Alpha</option>
                            <option value="project-beta">Project Beta</option>
                            <option value="project-gamma">Project Gamma</option>
                            <option value="maintenance">Maintenance</option>
                        </select>
                        <div class="form-text">Assign this task to a specific project</div>
                    </div>

                    <!-- Priority & Status -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label for="priority" class="form-label fw-medium">Priority <span class="text-danger">*</span></label>
                            <select class="form-select" id="priority" name="priority" required>
                                <option value="low">Low Priority</option>
                                <option value="medium" selected>Medium Priority</option>
                                <option value="high">High Priority</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="status" class="form-label fw-medium">Initial Status</label>
                            <select class="form-select" id="status" name="status">
                                <option value="pending" selected>Pending</option>
                                <option value="in_progress">In Progress</option>
                            </select>
                        </div>
                    </div>

                    <!-- Assignee & Due Date -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label for="assignee" class="form-label fw-medium">Assignee</label>
                            <select class="form-select" id="assignee" name="assignee">
                                <option value="">Assign to someone...</option>
                                <option value="john-doe">John Doe</option>
                                <option value="jane-smith">Jane Smith</option>
                                <option value="mike-johnson">Mike Johnson</option>
                                <option value="sarah-wilson">Sarah Wilson</option>
                                <option value="tom-brown">Tom Brown</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="due_date" class="form-label fw-medium">Due Date</label>
                            <input type="date" class="form-control" id="due_date" name="due_date">
                        </div>
                    </div>

                    <!-- Labels -->
                    <div class="mb-4">
                        <label class="form-label fw-medium">Labels</label>
                        <div class="row g-2">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="label_frontend" name="labels[]" value="frontend">
                                    <label class="form-check-label" for="label_frontend">Frontend</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="label_backend" name="labels[]" value="backend">
                                    <label class="form-check-label" for="label_backend">Backend</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="label_design" name="labels[]" value="design">
                                    <label class="form-check-label" for="label_design">Design</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="label_security" name="labels[]" value="security">
                                    <label class="form-check-label" for="label_security">Security</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="label_testing" name="labels[]" value="testing">
                                    <label class="form-check-label" for="label_testing">Testing</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="label_docs" name="labels[]" value="documentation">
                                    <label class="form-check-label" for="label_docs">Documentation</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-text">Tag your task with relevant categories</div>
                    </div>

                    <!-- Estimated Time -->
                    <div class="mb-4">
                        <label for="estimated_hours" class="form-label fw-medium">Estimated Time (Hours)</label>
                        <div class="row g-2">
                            <div class="col-md-6">
                                <input type="number" class="form-control" id="estimated_hours" name="estimated_hours" 
                                       min="0" max="999" step="0.5" placeholder="e.g., 8">
                            </div>
                            <div class="col-md-6">
                                <select class="form-select" id="complexity" name="complexity">
                                    <option value="">Complexity level...</option>
                                    <option value="simple">Simple (1-4 hours)</option>
                                    <option value="moderate">Moderate (4-16 hours)</option>
                                    <option value="complex">Complex (16+ hours)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-text">Help with planning and resource allocation</div>
                    </div>

                    <!-- Dependencies -->
                    <div class="mb-4">
                        <label for="dependencies" class="form-label fw-medium">Dependencies</label>
                        <select class="form-select" id="dependencies" name="dependencies[]" multiple>
                            <option value="task1">Setup database schema</option>
                            <option value="task2">Create user model</option>
                            <option value="task3">Design authentication flow</option>
                            <option value="task4">Setup testing framework</option>
                        </select>
                        <div class="form-text">Select tasks that must be completed before this one</div>
                    </div>

                    <!-- Task Options -->
                    <div class="mb-4">
                        <label class="form-label fw-medium">Task Options</label>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="recurring" name="options[]" value="recurring">
                            <label class="form-check-label" for="recurring">
                                <strong>Recurring Task</strong> - This task repeats on a schedule
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="milestone" name="options[]" value="milestone">
                            <label class="form-check-label" for="milestone">
                                <strong>Milestone</strong> - Mark this as a project milestone
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="urgent" name="options[]" value="urgent">
                            <label class="form-check-label" for="urgent">
                                <strong>Urgent</strong> - Requires immediate attention
                            </label>
                        </div>
                    </div>

                    <!-- Notification Settings -->
                    <div class="mb-4">
                        <label class="form-label fw-medium">Notifications</label>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="notify_assignee" name="notifications[]" value="assignee" checked>
                            <label class="form-check-label" for="notify_assignee">
                                Notify assignee when task is created
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="notify_due" name="notifications[]" value="due_date" checked>
                            <label class="form-check-label" for="notify_due">
                                Send reminder before due date
                            </label>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex gap-2 pt-3 border-top">
                        <button type="submit" class="btn btn-primary px-4">
                            <i class="fas fa-plus me-2"></i>Create Task
                        </button>
                        <button type="button" class="btn btn-outline-success px-4" onclick="saveAsDraft()">
                            <i class="fas fa-save me-2"></i>Save as Draft
                        </button>
                        <button type="button" class="btn btn-outline-info px-4" onclick="createAndAddAnother()">
                            <i class="fas fa-plus-circle me-2"></i>Create & Add Another
                        </button>
                        <a href="/tasks" class="btn btn-outline-secondary px-4">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    // Set default due date to one week from now
    const oneWeekFromNow = new Date();
    oneWeekFromNow.setDate(oneWeekFromNow.getDate() + 7);
    $('#due_date').val(oneWeekFromNow.toISOString().split('T')[0]);
    
    // Auto-suggest estimated hours based on complexity
    $('#complexity').on('change', function() {
        const complexity = $(this).val();
        let suggestedHours = '';
        
        switch(complexity) {
            case 'simple':
                suggestedHours = '2';
                break;
            case 'moderate':
                suggestedHours = '8';
                break;
            case 'complex':
                suggestedHours = '24';
                break;
        }
        
        if (suggestedHours && !$('#estimated_hours').val()) {
            $('#estimated_hours').val(suggestedHours);
        }
    });
    
    // Form validation
    $('#taskForm').on('submit', function(e) {
        const title = $('#title').val().trim();
        const project = $('#project').val();
        
        if (!title) {
            e.preventDefault();
            showError('Please enter a task title');
            $('#title').focus();
            return;
        }
        
        if (!project) {
            e.preventDefault();
            showError('Please select a project');
            $('#project').focus();
            return;
        }
        
        showSuccess('Creating task...');
    });
    
    // Priority color coding
    $('#priority').on('change', function() {
        const priority = $(this).val();
        $(this).removeClass('border-success border-warning border-danger');
        
        switch(priority) {
            case 'low':
                $(this).addClass('border-success');
                break;
            case 'medium':
                $(this).addClass('border-warning');
                break;
            case 'high':
                $(this).addClass('border-danger');
                break;
        }
    }).trigger('change');
});

function saveAsDraft() {
    showSuccess('Task saved as draft');
}

function createAndAddAnother() {
    showSuccess('Task created! Ready to add another task.');
    // In a real implementation, this would submit the form and then clear it
}
</script>

<style>
.form-control:focus,
.form-select:focus {
    border-color: #86b7fe;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

.border-success {
    border-color: #198754 !important;
}

.border-warning {
    border-color: #ffc107 !important;
}

.border-danger {
    border-color: #dc3545 !important;
}
</style>
{{end}}

{{template "layouts/app.tmpl" .}} 